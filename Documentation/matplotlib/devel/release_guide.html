
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Doing a matplotlib release &mdash; Matplotlib 1.3.1 documentation</title>
    <link rel="stylesheet" href="../_static/pythonista.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.3.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within Matplotlib 1.3.1 documentation"
          href="../_static/opensearch.xml"/>
    <link rel="top" title="Matplotlib 1.3.1 documentation" href="../index.html" />
    <link rel="up" title="The Matplotlib Developers’ Guide" href="index.html" />
    <link rel="next" title="Working with transformations" href="transformations.html" />
    <link rel="prev" title="Documenting matplotlib" href="documenting_mpl.html" />
    <link rel="shortcut icon" type="image/png" href="../_static/py.png" />
    <link rel="stylesheet" href="../_static/pythonista.css" type="text/css" />
    <meta name = "viewport" content = "width=device-width,initial-scale=1.0,user-scalable=no;">
    
    <script type="text/javascript">
        var getTextForSample = function(i) {
            codeBlock = document.getElementsByClassName('highlight-python')[i];
            return codeBlock.innerText;
        }
        
        var copySample = function (i) {
            window.location.href = '/__pythonista_copy__/' + encodeURI(getTextForSample(i));
        }
        
        var openSample = function (i) {
            window.location.href = '/__pythonista_open__/' + encodeURI(getTextForSample(i));
        }
        
        //Source: http://ejohn.org/blog/partial-functions-in-javascript/
        Function.prototype.partial = function() {
        	var fn = this,
        		args = Array.prototype.slice.call(arguments);
        	return function() {
        		var arg = 0;
        		for (var i = 0; i < args.length && arg < arguments.length; i++)
        		if (args[i] === undefined) args[i] = arguments[arg++];
        		return fn.apply(this, args);
        	};
        };
        
        window.onload=function() {
            //Add "Copy" and "Open in Editor" buttons for code samples:
            var inApp = navigator.userAgent.match(/AppleWebKit/i) != null && navigator.userAgent.match(/Safari/i) == null;
            if (inApp) {
                codeBlocks = document.getElementsByClassName('highlight-python');
                for (var i = 0; i < codeBlocks.length; i++) {
                    codeBlock = codeBlocks[i];
                    if (codeBlock.innerText.indexOf('>>>') == 0) {
                        //Don't add header for interactive sessions
                        continue;
                    }

                    var codeHeader = document.createElement('div');
                    codeHeader.className = 'pythonista-code-header';

                    var copyButton = document.createElement('button');
                    copyButton.className = 'pythonista-button';
                    copyButton.innerText = 'Copy';
                    copyButton.addEventListener('click', copySample.partial(i));
                    codeHeader.appendChild(copyButton);

                    var openButton = document.createElement('button');
                    openButton.className = 'pythonista-button';
                    openButton.innerText = 'Open in Editor';
                    openButton.addEventListener('click', openSample.partial(i));
                    codeHeader.appendChild(openButton);

                    codeBlock.parentElement.insertBefore(codeHeader, codeBlock);
                }
            }
        }
    </script>
    
 

  </head>
  <body ontouchstart="">
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="transformations.html" title="Working with transformations"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="documenting_mpl.html" title="Documenting matplotlib"
             accesskey="P">previous</a> |</li>
        <li><a href="http://omz-software.com/pythonista"><img src="../_static/py.png" alt=""
                 style="vertical-align: middle; margin-top: -4px; margin-right: 4px;"/></a></li>
        <li><a href="../index.html">Matplotlib 1.3.1 documentation</a> &raquo;</li>

          <li><a href="index.html" accesskey="U">The Matplotlib Developers&#8217; Guide</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
          <div class="body">
            
  <div class="section" id="doing-a-matplotlib-release">
<span id="release-guide"></span><h1>Doing a matplotlib release<a class="headerlink" href="#doing-a-matplotlib-release" title="Permalink to this headline">¶</a></h1>
<p>A guide for developers who are doing a matplotlib release.</p>
<ul class="simple">
<li>Edit <tt class="file docutils literal"><span class="pre">__init__.py</span></tt> and bump the version number</li>
</ul>
<div class="section" id="testing">
<span id="release-testing"></span><h2>Testing<a class="headerlink" href="#testing" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Run all of the regression tests by running the <tt class="xref py py-obj docutils literal"><span class="pre">tests.py</span></tt> script at
the root of the source tree.</li>
<li>Run <tt class="file docutils literal"><span class="pre">unit/memleak_hawaii3.py</span></tt> and make sure there are no
memory leaks</li>
<li>try some GUI examples, eg <tt class="file docutils literal"><span class="pre">simple_plot.py</span></tt> with GTKAgg, TkAgg, etc...</li>
<li>remove font cache and tex cache from <tt class="file docutils literal"><span class="pre">.matplotlib</span></tt> and test
with and without cache on some example script</li>
<li>Optionally, make sure <tt class="file docutils literal"><span class="pre">examples/tests/backend_driver.py</span></tt> runs
without errors and check the output of the PNG, PDF, PS and SVG
backends</li>
</ul>
</div>
<div class="section" id="branching">
<span id="release-branching"></span><h2>Branching<a class="headerlink" href="#branching" title="Permalink to this headline">¶</a></h2>
<p>Once all the tests are passing and you are ready to do a release, you
need to create a release branch.  These only need to be created when
the second part of the version number changes:</p>
<div class="highlight-python"><div class="highlight"><pre>git checkout -b v1.1.x
git push git@github.com:matplotlib/matplotlib.git v1.1.x
</pre></div>
</div>
<p>On the branch, do any additional testing you want to do, and then build
binaries and source distributions for testing as release candidates.</p>
<p>For each release candidate as well as for the final release version,
please <tt class="xref py py-obj docutils literal"><span class="pre">git</span> <span class="pre">tag</span></tt> the commit you will use for packaging like so:</p>
<div class="highlight-python"><div class="highlight"><pre>git tag -a v1.1.0rc1
</pre></div>
</div>
<p>The <tt class="xref py py-obj docutils literal"><span class="pre">-a</span></tt> flag will allow you to write a message about the tag, and
affiliate your name with it. A reasonable tag message would be something
like <tt class="docutils literal"><span class="pre">v1.1.0</span> <span class="pre">Release</span> <span class="pre">Candidate</span> <span class="pre">1</span> <span class="pre">(September</span> <span class="pre">24,</span> <span class="pre">2011)</span></tt>. To tag a
release after the fact, just track down the commit hash, and:</p>
<div class="highlight-python"><div class="highlight"><pre>git tag -a v1.0.1rc1 a9f3f3a50745
</pre></div>
</div>
<p>Tags allow developers to quickly checkout different releases by name,
and also provides source download via zip and tarball on github.</p>
<p>Then push the tags to the main repository:</p>
<div class="highlight-python"><div class="highlight"><pre>git push upstream v1.0.1rc1
</pre></div>
</div>
</div>
<div class="section" id="packaging">
<span id="release-packaging"></span><h2>Packaging<a class="headerlink" href="#packaging" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Make sure the <tt class="file docutils literal"><span class="pre">MANIFEST.in</span></tt> is up to date and remove
<tt class="file docutils literal"><span class="pre">MANIFEST</span></tt> so it will be rebuilt by MANIFEST.in</li>
<li>run <tt class="xref py py-obj docutils literal"><span class="pre">git</span> <span class="pre">clean</span></tt> in the mpl git directory before building the sdist</li>
<li>unpack the sdist and make sure you can build from that directory</li>
<li>Use <tt class="file docutils literal"><span class="pre">setup.cfg</span></tt> to set the default backends.  For windows and
OSX, the default backend should be TkAgg.  You should also turn on
or off any platform specific build options you need.  Importantly,
you also need to make sure that you delete the <tt class="file docutils literal"><span class="pre">build</span></tt> dir
after any changes to <tt class="file docutils literal"><span class="pre">setup.cfg</span></tt> before rebuilding since cruft
in the <tt class="file docutils literal"><span class="pre">build</span></tt> dir can get carried along.</li>
<li>On windows, unix2dos the rc file.</li>
<li>We have a Makefile for the OS X builds in the mpl source dir
<tt class="file docutils literal"><span class="pre">release/osx</span></tt>, so use this to prepare the OS X releases.</li>
<li>We have a Makefile for the win32 mingw builds in the mpl source dir
<tt class="file docutils literal"><span class="pre">release/win32</span></tt> which you can use this to prepare the windows
releases.</li>
</ul>
</div>
<div class="section" id="posting-files">
<h2>Posting files<a class="headerlink" href="#posting-files" title="Permalink to this headline">¶</a></h2>
<p>Our current method is for the release manager to collect all of the
binaries from the platform builders and post the files online on
Sourceforge.  It is also possible that those building the binaries
could upload to directly to Sourceforge.</p>
<p>There are many ways to upload files to Sourceforge (<tt class="xref py py-obj docutils literal"><span class="pre">scp</span></tt>, <tt class="xref py py-obj docutils literal"><span class="pre">rsync</span></tt>,
<tt class="xref py py-obj docutils literal"><span class="pre">sftp</span></tt>, and a web interface) described in <a class="reference external" href="https://sourceforge.net/apps/trac/sourceforge/wiki/Release%20files%20for%20download">Sourceforge Release File
System documentation</a>.
Below, we will use <tt class="xref py py-obj docutils literal"><span class="pre">sftp</span></tt>.</p>
<ol class="arabic">
<li><p class="first">Create a directory containing all of the release files and <tt class="xref py py-obj docutils literal"><span class="pre">cd</span></tt> to it.</p>
</li>
<li><p class="first"><tt class="xref py py-obj docutils literal"><span class="pre">sftp</span></tt> to Sourceforge:</p>
<div class="highlight-python"><div class="highlight"><pre>sftp USERNAME@frs.sourceforge.net:/home/frs/project/matplotlib/matplotlib
</pre></div>
</div>
</li>
<li><p class="first">Make a new directory for the release and move to it:</p>
<div class="highlight-python"><div class="highlight"><pre>mkdir matplotlib-1.1.0rc1
cd matplotlib-1.1.0rc1
</pre></div>
</div>
</li>
<li><p class="first">Upload all of the files in the current directory on your local machine:</p>
<div class="highlight-python"><div class="highlight"><pre>put *
</pre></div>
</div>
</li>
</ol>
<p>If this release is a final release, the default download for the
matplotlib project should also be updated.  Login to Sourceforge and
visit the <a class="reference external" href="https://sourceforge.net/projects/matplotlib/files/matplotlib/">matplotlib files page</a>.
Navigate to the tarball of the release you just updated, click on
&#8220;Details&#8221; icon (it looks like a lower case <tt class="docutils literal"><span class="pre">i</span></tt>), and make it the
default download for all platforms.</p>
<p>There is a list of direct links to downloads on matplotlib&#8217;s main
website.  This needs to be manually generated and updated every time
new files are posted.</p>
<ol class="arabic">
<li><p class="first">Clone the matplotlib documentation repository and <tt class="xref py py-obj docutils literal"><span class="pre">cd</span></tt> into it:</p>
<div class="highlight-python"><div class="highlight"><pre>git clone git@github.com:matplotlib/matplotlib.github.com.git
cd matplotlib.github.com
</pre></div>
</div>
</li>
<li><p class="first">Update the list of downloads that you want to display by editing
the <tt class="xref py py-obj docutils literal"><span class="pre">downloads.txt</span></tt> file.  Generally, this should contain the last two
final releases and any active release candidates.</p>
</li>
<li><p class="first">Update the downloads webpage by running the <tt class="xref py py-obj docutils literal"><span class="pre">update_downloads.py</span></tt>
script.  This script requires <tt class="xref py py-obj docutils literal"><span class="pre">paramiko</span></tt> (for <tt class="xref py py-obj docutils literal"><span class="pre">sftp</span></tt> support) and
<tt class="xref py py-obj docutils literal"><span class="pre">jinja2</span></tt> for templating.  Both of these dependencies can be
installed using pip:</p>
<div class="highlight-python"><div class="highlight"><pre>pip install paramiko
pip install jinja2
</pre></div>
</div>
<p>Then update the download page:</p>
<div class="highlight-python"><div class="highlight"><pre>./update_downloads.py
</pre></div>
</div>
<p>You will be prompted for your Sourceforge username and password.</p>
</li>
<li><p class="first">Commit the changes and push them up to github:</p>
<div class="highlight-python"><div class="highlight"><pre>git commit -m &quot;Updating download list&quot;
git push
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="update-pypi">
<h2>Update PyPI<a class="headerlink" href="#update-pypi" title="Permalink to this headline">¶</a></h2>
<p>Once the tarball has been posted on Sourceforge, you can register a
link to the new release on PyPI.  This should only be done with final
(non-release-candidate) releases, since doing so will hide any
available stable releases.</p>
<p>You may need to set up your <tt class="xref py py-obj docutils literal"><span class="pre">pypirc</span></tt> file as described in the
<a class="reference external" href="http://docs.python.org/2/distutils/packageindex.html">distutils register command documentation</a>.</p>
<p>Then updating the record on PyPI is as simple as:</p>
<div class="highlight-python"><div class="highlight"><pre>python setup.py register
</pre></div>
</div>
<p>This will hide any previous releases automatically.</p>
</div>
<div class="section" id="documentation-updates">
<h2>Documentation updates<a class="headerlink" href="#documentation-updates" title="Permalink to this headline">¶</a></h2>
<p>The built documentation exists in the <a class="reference external" href="https://github.com/matplotlib/matplotlib.github.com/">matplotlib.github.com</a> repository.
Pushing changes to master automatically updates the website.</p>
<p>The documentation is organized by version.  At the root of the tree is
always the documentation for the latest stable release.  Under that,
there are directories containing the documentation for older versions
as well as the bleeding edge release version called <tt class="xref py py-obj docutils literal"><span class="pre">dev</span></tt> (usually
based on what&#8217;s on master in the github repository, but it may also
temporarily be a staging area for proposed changes).  There is also a
symlink directory with the name of the most recently released version
that points to the root.  With each new release, these directories may
need to be reorganized accordingly.  Any time these version
directories are added or removed, the <tt class="xref py py-obj docutils literal"><span class="pre">versions.html</span></tt> file (which
contains a list of the available documentation versions for the user)
must also be updated.</p>
<p>To make sure everyone&#8217;s hard work gets credited, regenerate the github
stats.  <tt class="xref py py-obj docutils literal"><span class="pre">cd</span></tt> into the tools directory and run:</p>
<div class="highlight-python"><div class="highlight"><pre>python github_stats.py $TAG &gt; ../doc/users/github_stats.rst
</pre></div>
</div>
<p>where <tt class="xref py py-obj docutils literal"><span class="pre">$TAG</span></tt> is the tag of the last major release.  This will generate
stats for all work done since that release.</p>
<p>In the matplotlib source repository, build the documentation:</p>
<div class="highlight-python"><div class="highlight"><pre>cd doc
python make.py html
python make.py latex
</pre></div>
</div>
<p>Then copy the build products into your local checkout of the
<tt class="xref py py-obj docutils literal"><span class="pre">matplotlib.github.com</span></tt> repository (assuming here to be checked out in
<tt class="xref py py-obj docutils literal"><span class="pre">com</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre>cp -r build/html/* ~/matplotlib.github.com
cp build/latex/Matplotlib.pdf ~/matplotlib.github.com
</pre></div>
</div>
<p>Then, from the <tt class="xref py py-obj docutils literal"><span class="pre">matplotlib.github.com</span></tt> directory, commit and push the
changes upstream:</p>
<div class="highlight-python"><div class="highlight"><pre>git commit -m &quot;Updating for v1.0.1&quot;
git push upstream master
</pre></div>
</div>
</div>
<div class="section" id="announcing">
<h2>Announcing<a class="headerlink" href="#announcing" title="Permalink to this headline">¶</a></h2>
<p>Announce the release on matplotlib-announce, matplotlib-users, and
matplotlib-devel.  Final (non-release-candidate) versions should also
be announced on python-announce.  Include a summary of highlights from
the CHANGELOG and/or post the whole CHANGELOG since the last release.</p>
</div>
</div>


          </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
    &copy; <a href="../copyright.html">Copyright</a> 2002 - 2012 John Hunter, Darren Dale, Eric Firing, Michael Droettboom and the matplotlib development team; 2012 - 2013 The matplotlib development team.
    <br />
    The Python Software Foundation is a non-profit corporation.  
    <a href="http://www.python.org/psf/donations/">Please donate.</a>
    <br />
    Last updated on May 03, 2016.
    <a href="../bugs.html">Found a bug</a>?
    <br />
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2.1.
    </div>

  </body>
</html>